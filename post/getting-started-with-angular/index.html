<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Angular 简易入门 - Bigshans&#39; Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="bigshans" />
<meta name="description" content="因为最近重新用了用 Angular ，在有了 Vue 和 React 的使用经验之后，对 Angular 又有了新的理解。 Angular 是真正意义上与 Vue 和 React 区分的框架，因为其思想与二者截然不同。不过我不讨" /><meta name="keywords" content="Hugo, theme, even" />








<meta name="generator" content="Hugo 0.105.0-DEV with theme even" />


<link rel="canonical" href="https://bigshans.github.io/post/getting-started-with-angular/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.c00e94730a6b40627ede15c565a0d79571bffdc2a57669406c4d3099af8ca3b4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/custom.css">





<meta property="og:title" content="Angular 简易入门" />
<meta property="og:description" content="因为最近重新用了用 Angular ，在有了 Vue 和 React 的使用经验之后，对 Angular 又有了新的理解。 Angular 是真正意义上与 Vue 和 React 区分的框架，因为其思想与二者截然不同。不过我不讨" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bigshans.github.io/post/getting-started-with-angular/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-06T09:29:04+08:00" />
<meta property="article:modified_time" content="2021-12-06T09:29:04+08:00" />

<meta itemprop="name" content="Angular 简易入门">
<meta itemprop="description" content="因为最近重新用了用 Angular ，在有了 Vue 和 React 的使用经验之后，对 Angular 又有了新的理解。 Angular 是真正意义上与 Vue 和 React 区分的框架，因为其思想与二者截然不同。不过我不讨"><meta itemprop="datePublished" content="2021-12-06T09:29:04+08:00" />
<meta itemprop="dateModified" content="2021-12-06T09:29:04+08:00" />
<meta itemprop="wordCount" content="3648">
<meta itemprop="keywords" content="前端,Angular," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Angular 简易入门"/>
<meta name="twitter:description" content="因为最近重新用了用 Angular ，在有了 Vue 和 React 的使用经验之后，对 Angular 又有了新的理解。 Angular 是真正意义上与 Vue 和 React 区分的框架，因为其思想与二者截然不同。不过我不讨"/>



<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->



<script type="text/javascript" src="/js/filled.js"></script>

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Bigshans</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item fa">
          
            <i class="fa-home"></i>
          

          首页
        </li>
      </a><a href="/post/">
        <li class="mobile-menu-item fa">
          
            <i class="fa-archives"></i>
          

          归档
        </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item fa">
          
            <i class="fa-tags"></i>
          

          标签
        </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item fa">
          
            <i class="fa-categories"></i>
          

          分类
        </li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Bigshans</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <span class="fa">
          
            <i class="fa-home"></i>
          
        </span>
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <span class="fa">
          
            <i class="fa-archives"></i>
          
        </span>
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <span class="fa">
          
            <i class="fa-tags"></i>
          
        </span>
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <span class="fa">
          
            <i class="fa-categories"></i>
          
        </span>
        <a class="menu-item-link" href="/categories/">分类</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Angular 简易入门</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-12-06 </span>
        <div class="post-category">
            <a href="/categories/angular/"> Angular </a>
            </div>
          <span class="more-meta"> 约 3648 字 </span>
          <span class="more-meta"> 预计阅读 8 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#前言">前言</a></li>
        <li><a href="#ng-cli-安装">ng cli 安装</a></li>
        <li><a href="#module">module</a></li>
        <li><a href="#生成一个-component">生成一个 component</a></li>
        <li><a href="#生成一个-service">生成一个 service</a></li>
        <li><a href="#控制反转和依赖注入">控制反转和依赖注入</a></li>
        <li><a href="#rxjs">RxJS</a></li>
        <li><a href="#模板基本语法">模板基本语法</a>
          <ul>
            <li><a href="#ngif"><code>*ngIf</code></a></li>
            <li><a href="#ngfor"><code>*ngFor</code></a></li>
            <li><a href="#事件处理">事件处理</a></li>
          </ul>
        </li>
        <li><a href="#自定义插槽">自定义插槽</a>
          <ul>
            <li><a href="#定义入参">定义入参</a></li>
            <li><a href="#定义事件">定义事件</a></li>
          </ul>
        </li>
        <li><a href="#组件路由">组件路由</a>
          <ul>
            <li><a href="#路由跳转">路由跳转</a></li>
            <li><a href="#获取参数">获取参数</a></li>
          </ul>
        </li>
        <li><a href="#组件引用">组件引用</a></li>
        <li><a href="#ng-template"><code>ng-template</code></a></li>
        <li><a href="#rxjs-的使用">RxJS 的使用</a></li>
        <li><a href="#httpclient"><code>HttpClient</code></a></li>
        <li><a href="#angular-的生命周期">Angular 的生命周期</a>
          <ul>
            <li><a href="#生命周期钩子">生命周期钩子</a></li>
          </ul>
        </li>
        <li><a href="#结尾">结尾</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
</div>

    <div class="post-content">
      <p>因为最近重新用了用 Angular ，在有了 Vue 和 React 的使用经验之后，对 Angular 又有了新的理解。 Angular 是真正意义上与 Vue 和 React 区分的框架，因为其思想与二者截然不同。不过我不讨论这个，我是来讲 Angular 入门。</p>
<h2 id="前言">前言</h2>
<p>Angular 教程，官方有一个非常好的已经提供了，我这里主要是整理一些要点与语法点，方便快速学习 Angular 。当然，按照官方教程走一遍是再好不过的了，我当时跟着教程回忆也不过一两个小时。</p>
<p>Angluar 就其结构而言，是严格规定了编程方法。作为工程而言是相当规范的，但若是作为小项目，则拘束地很了。不过，好处就是， Angular 为各种情况都制定了解决方案。望各位能根据实情选定技术。</p>
<h2 id="ng-cli-安装">ng cli 安装</h2>
<p>首先，需要全局安装 ng 。</p>
<pre><code class="language-shell">npm install -g @angular/cli
</code></pre>
<p>Angular 的编程很繁琐，重复代码太多，不少代码是为了设计模式而设计的，与业务本身无关。 ng 的一大作用就是自动生成代码以解决繁琐的重复编码问题。</p>
<p>ng 的另一大作用就是项目的搭建与构建， ng 可以很方便地添加模块并且自动地做好一些默认配置，比如说 SSR ，比如说 zorro ，使用 ng 都可以快速地将代码融入项目。</p>
<p>ng 是 Angular 用以解决自身问题的 cli 工具，本身也是属于 Angular 的一部分，目的就是为了减轻 Angular 本身的繁琐。</p>
<h2 id="module">module</h2>
<p>如果不是写框架的话，实际上接触到的 module 文件就只有 <code>app.module.ts</code> 了。</p>
<p>在 module 里面我们不需要知道太多，经常接触的就只有两个，一个是 <code>declarations</code> ，另一个是 <code>imports</code> ，前者用于声明组件，后者用于引入 module 。</p>
<p>其他一些配置的内容往往也写于此。</p>
<h2 id="生成一个-component">生成一个 component</h2>
<p>我们一般使用 ng 生成 component 所需的基础代码。</p>
<pre><code class="language-shell">ng generate component component-name --module=app.module
</code></pre>
<p>然后 ng 就会生成对应的目录以及文件到 app 目录下。</p>
<pre><code>src/app/component-name
├── component-name.component.html
├── component-name.component.css
├── component-name.component.spec.ts
└── component-name.component.ts
</code></pre>
<p>其中，样式文件也可以是 less 或是 scss ，总之，看你喜欢。</p>
<ul>
<li>
<p><code>.component.html</code> 组件的模板文件。</p>
</li>
<li>
<p><code>.component.css</code> 模板的样式文件。</p>
</li>
<li>
<p><code>.component.spec.ts</code> 测试文件。</p>
</li>
<li>
<p><code>.component.ts</code> 组件的主要代码。</p>
</li>
</ul>
<p>Angular 是一门很 OO 的框架， <code>.component.ts</code> 主要导出了一个 Component 类，主要逻辑都在 Component 类里完成。</p>
<p>新加的组件需要在 <code>app.component.html</code> 或相关的内容中被使用。而且一旦声明就是全局使用的， ng 默认会添加入 <code>declarations</code> 里，不需要手动处理。</p>
<h2 id="生成一个-service">生成一个 service</h2>
<p>service 这个词，在 Vue 和 React 中已经很少听见了。我们使用 ng 生成 service 代码。</p>
<pre><code class="language-shell">ng generate service service-name
</code></pre>
<p>然后生成 <code>.service.ts</code> 文件。 service 层主要是为了提供各种无关视图的服务， Vue 和 React 虽然没有名为 service 的文件，但不代码不编写实质为 service 的代码。</p>
<p>一个 service 默认没有被引用，因此也不会被编译，知道被引用为止。</p>
<p>到此为止，编写一个组件所需要的文件基本上是备足了。</p>
<h2 id="控制反转和依赖注入">控制反转和依赖注入</h2>
<p>Angular 利用 TypeScript 的装饰器实现了类似与 Java Spring 的控制反转与依赖注入。</p>
<p>在 component 和 service 中，我们都可以使用依赖注入的方式来注入依赖，而不用费劲巴拉地自己写初始化条件。最常用的，可以在 component 中注入各种 service 。</p>
<p>同时，装饰器也作为插错的实现，形式上也更为简洁了。</p>
<p>值得注意地是， Anuglar 一般来说是单例工厂。</p>
<p>依赖注入的写法，我们一般参照官网。</p>
<pre><code class="language-typescript">constructor(
    private route: ActivatedRoute,
) {}
</code></pre>
<h2 id="rxjs">RxJS</h2>
<p>与 Vue 和 React 不同地是， Angular 没有类似 Vuex 或 Redux 的状态管理库，一般会使用 RxJS 解决。</p>
<p>为什么是 RxJS 呢？ RxJS 是个处理异步数据的框架，而 Angular 引入 RxJS 就是为了让异步更可控、更简单。所谓状态管理，换一个角度看也是同一时间线上不同事件的管理，而 RxJS 恰巧也能做到。因此，用 RxJS 进行状态管理是再合适不过的了。</p>
<p>RxJS 的具体使用我不会在这里讲，下面会提到一点，但不会展开。因为基本上是 RxJS 的基本用法。</p>
<h2 id="模板基本语法">模板基本语法</h2>
<p>对比 Vue 和 React ， Angular 是更基于模板的框架。</p>
<p>在 Angular 中，除了自定义组件外，我们基本上不能使用自定义标签。在模板中，我们可以调用变量，而这些变量则来自于与<u>它对应的组件类</u>的 <code>public</code> 部分。</p>
<p>我们可以使用 <code>{{}}</code> 进行插值。</p>
<p>而对于标签或组件进行值绑定，我们使用 <code>[]</code> ；进行事件绑定，使用 <code>()</code> ；进行双向绑定，使用 <code>[()]</code> ，需要注意的是，双向绑定需要引入 <code>FormsModule</code> 。</p>
<p>对于一般的标签，还需要记忆的是：</p>
<ul>
<li>
<p><code>[ngClass]</code> ，动态的 <code>class</code> 绑定。</p>
</li>
<li>
<p><code>[ngStyle]</code> ，动态的 <code>style</code> 绑定。</p>
</li>
<li>
<p><code>[innerHTML]</code> 等各种与原生属性的绑定。</p>
</li>
<li>
<p><code>(mouseover)</code> 等各种事件绑定。</p>
</li>
</ul>
<p>当然，最重要的，还有 if 、 for 等控制流。</p>
<h3 id="ngif"><code>*ngIf</code></h3>
<p><code>*ngIf</code> 是个语法糖，比较不幸地是， Angular 没有 else 模板以及 else if 模板。</p>
<pre><code class="language-html">&lt;div *ngIf=&quot;world&quot;&gt;
    hello {{world.name}}
&lt;/div&gt;
</code></pre>
<p>如果我们想要表达 else ，我们可以用 if 的否定来表达。</p>
<pre><code class="language-html">&lt;div *ngIf=&quot;world&quot;&gt;
    hello {{world.name}}
&lt;/div&gt;
&lt;div *ngIf=&quot;!world&quot;&gt;
    hello world
&lt;/div&gt;
</code></pre>
<p>在 Angular ，还可以使用 <code>ng-template</code> 来实现 else 。</p>
<pre><code class="language-html">&lt;div *ngIf=&quot;world; else ElseWorld&quot;&gt;
    hello {{world.name}}
&lt;/div&gt;
&lt;ng-template #ElseWorld&gt;
    hello world
&lt;/ng-template&gt;
</code></pre>
<p>这种方法缺点也很明显，污染了命名空间。</p>
<h3 id="ngfor"><code>*ngFor</code></h3>
<p>Angular 的循环写起来是最方便的。</p>
<pre><code class="language-html">&lt;div *ngFor=&quot;let img of imgs&quot;&gt;
    &lt;img [src]=&quot;img&quot; /&gt;
&lt;/div&gt;
</code></pre>
<p>如果我们需要 index 的话也可以拿到。</p>
<pre><code class="language-html">&lt;div *ngFor=&quot;let img of imgs; let i = index;&quot;&gt;
    &lt;img [src]=&quot;img&quot; [alt]=&quot;i&quot; /&gt;
&lt;/div&gt;
</code></pre>
<h3 id="事件处理">事件处理</h3>
<p>值得注意的是， Angular 绑定事件并不是那么直觉。</p>
<p>比如，如下代码中的 <code>click</code> 事件并不会被触发。</p>
<pre><code class="language-html">&lt;i (click)=&quot;click&quot;&gt;Click Me&lt;/i&gt;
</code></pre>
<p>除非你显式调用：</p>
<pre><code class="language-html">&lt;i (click)=&quot;click()&quot;&gt;Click Me&lt;/i&gt;
</code></pre>
<p>但这样我们并没有获得事件的输入，在 Angular 中，我们需要显式引用 <code>$event</code> 变量。</p>
<pre><code class="language-html">&lt;i (click)=&quot;click($event)&quot;&gt;Click Me&lt;/i&gt;
</code></pre>
<p>这样的写法更多地是在提醒你，这个是事件绑定，而不是类似于 React 的函数传递。</p>
<h2 id="自定义插槽">自定义插槽</h2>
<p>Angular 中自定义插槽需要在对应的组件类里实现。</p>
<p><code>@Input()</code> 定义插槽的输入参数， <code>@Output()</code> 定义插槽的发送事件。</p>
<h3 id="定义入参">定义入参</h3>
<p>入参的定义其实非常简单。</p>
<pre><code class="language-typescript">@Input() n: number;
</code></pre>
<p>这样我们就定义了一个参数 <code>n</code> ，类型为 <code>number</code> ，该参数需要我们传入：</p>
<pre><code class="language-html">&lt;component-a [n]=&quot;5&quot;&gt;&lt;/component-a&gt;
</code></pre>
<p>如果我们要定义必传参数，就需要修改组件类的 <code>selector</code> 。比如上面的例子，如果我们要令 <code>n</code> 为必传，则须这样定义 <code>selector</code> 。</p>
<pre><code class="language-typescript">selector: 'component-a[n]'
</code></pre>
<h3 id="定义事件">定义事件</h3>
<p>定义事件就稍微复杂一点，我们需要定义一个 <code>EventEmitter</code> 对象。</p>
<pre><code class="language-typescript">@Output() onBuy = new EventEmitter();
</code></pre>
<p>其中，变量名就是可绑定的事件名。</p>
<p><code>EventEmitter</code> 是一个模板类，默认类型是 <code>any</code> 。向外部发送事件我们使用 <code>emit(value?: any)</code> 方法。</p>
<pre><code class="language-typescript">this.onBuy.emit(p);
</code></pre>
<p>其他组件想要绑定事件的方法我上面讲过了。</p>
<h2 id="组件路由">组件路由</h2>
<p>Angular 的路由配置主要在 <code>app-routing.module.ts</code> 文件中。一般如果你需要路由的话，那你在初始化项目的时候选择就有了。即使没有，后续 ng 安装 @angular/router 模块也可以。</p>
<p>配置核心在 <code>Routes</code> 数组。</p>
<pre><code class="language-typescript">const routes: Routes = [
    { path: '', component: HomeComponent },
    { path: 'detail/:id', component: DetailComponent },
];
</code></pre>
<p>以上是一个简单的示例。</p>
<p>完成基本的路由配置后，我们如何将值展示出来呢？我们使用 <code>router-outlet</code> 组件。</p>
<pre><code class="language-html">&lt;div&gt;
    &lt;router-outlet&gt;&lt;/router-outlet&gt;
&lt;/div&gt;
</code></pre>
<h3 id="路由跳转">路由跳转</h3>
<h4 id="编程式跳转">编程式跳转</h4>
<p>说白了就是编写代码进行路由跳转。为了实现这一点，我们需要首先注入路由对象，也就是 <code>Router</code> 对象，如果需要暴露给组件，则需要定义为 <code>public</code> 。</p>
<p>跳转代码举个例子：</p>
<pre><code class="language-typescript">this.router.navigate(['/detail'], {queryParams: {url: v}})
</code></pre>
<h4 id="导航式跳转">导航式跳转</h4>
<pre><code class="language-html">&lt;div routerLink=&quot;['/path']&quot; [queryParams]=&quot;{id:key}&quot; &gt;跳转&lt;/div&gt;
</code></pre>
<h3 id="获取参数">获取参数</h3>
<p>首先需要注入一个 <code>ActivatedRoute</code> 。</p>
<pre><code class="language-typescript">const id = this.route.snapshot.paramMap.get('id') || this.route.snapshot.queryParams.id;
const url = this.route.snapshot.queryParams.url;
</code></pre>
<p>参数位于 <code>snapshot</code> 属性中。</p>
<h2 id="组件引用">组件引用</h2>
<p>有些时候我们会需要在代码中操作 DOM ，这时候我们就需要获取到组件对象，对于一般的 DOM 对象我们可以用 <code>querySelector()</code> 等方法进行获取，但对于组件就不行了。 Vue 和 React 都提供了 ref ， Angular 也提供了类似的方案。</p>
<p>引用组件首先需要为组件赋予名字。</p>
<pre><code class="language-html">&lt;component-a #comp&gt;&lt;/component-a&gt;
</code></pre>
<p><code>#</code> 之后跟着的就是组件的名字，之后我们使用 <code>@ViewChild()</code> 获取组件引用。</p>
<pre><code class="language-typescript">@ViewChild('comp') compA: ElementRef;
</code></pre>
<p>然后组件引用就会自动注入到组件中。除了 <code>ElementRef</code> 外， <code>TemplateRef</code> 也是可以的，但 <code>TemplateRef</code> 用于 <code>ng-template</code> 。</p>
<p>对于 DOM 对象，我们可以以同样的方式获取。</p>
<pre><code class="language-typescript">compA.nativeElement;
</code></pre>
<p>上面将获得原生 DOM 元素的引用。</p>
<p>除此之外，我们也可以直接注入。</p>
<pre><code class="language-typescript">constructor(private el:ElementRef){}

ngOnInit(){
    console.log(this.el.nativeElement);
    console.log(this.el.nativeElement.querySelector('.box'));
}
</code></pre>
<h2 id="ng-template"><code>ng-template</code></h2>
<p>Angular 的 <code>ng-template</code> 跟 Vue 和 React 的 <code>template</code> 是完全不一样的。 Angular 的 <code>ng-template</code> 是不会在代码中被展示的。 <code>ng-template</code> 常被作为变量的值来传入到其他组件内，类似 <code>slots</code> 的作用。</p>
<h2 id="rxjs-的使用">RxJS 的使用</h2>
<p>在 Angular 中大量使用了 <code>RxJS</code> ，比如 Angular 自带的 <code>HttpClient</code> 就是使用 RxJS 的。</p>
<p>RxJS 的教程我就不赘述了，具体可以参看我之前写的<a href="https://bigshans.github.io/post/rxjs-exploration/">文章</a>。在 Angular 中，我们用的比较多的是各种 <code>Observable</code> 还有 <code>Subject</code> 们， RxJS 可以很方便地帮我们实现多播，以及各种 watch 。</p>
<p>需要注意的是，组件在订阅完成之后，不要忘了及时取消订阅，不然容易出现内存泄漏的问题。</p>
<p>关于这个问题，我建议阅读这篇文章 <a href="https://limeii.github.io/2019/08/rxjs-unsubscribe/">RxJS：所有订阅都需要调用 unsubscribe 取消订阅？</a> 。</p>
<h2 id="httpclient"><code>HttpClient</code></h2>
<p>Angular 非常贴心地内置了 Ajax 库，若单论好用，是真的称不上好用的，但不用再添加一个外部依赖，且与 Angular 风格贴合，总的来说是推荐使用的。</p>
<p><code>HttpClient</code> 需要自己注入到类里，我个人是倾向于封装成一个通用的请求方法并放在一个 Service 里处理。其中， <code>HttpClient</code> 有几个坑点我说一下。</p>
<pre><code class="language-typescript">get&lt;R=any, T = any&gt;(api: string, param?: T) {
  const params = param ? generateHttpParam(param) : new HttpParams();
  return this.http.get&lt;GlobalResponse&lt;R&gt;&gt;(
    this.genUrl(api),
    {
      headers: this.headers,
      params
    });
}
</code></pre>
<p><code>HttpClient</code> 的 <code>get()</code> 方法有一个问题就是 <code>params</code> 不是那么好处理，我写的时候就觉得这玩意儿有点反直觉。</p>
<pre><code class="language-typescript">function generateHttpParam(param: any) {
  let params = new HttpParams();
  params = Object.keys(param)
    .reduce((x: HttpParams, k: string) =&gt;
      x.set(k, param[k as any]), params);
  return params;
}
</code></pre>
<p><code>params</code> 必须不停地被覆盖。</p>
<p>对比之下， POST 就比较简单了。</p>
<pre><code class="language-typescript">post&lt;R=any, T = any&gt;(api: string, body?: T) {
  return this.http.post&lt;GlobalResponse&lt;R&gt;&gt;(
    this.genUrl(api),
    body,
    {
      headers: this.headers,
    });
}
</code></pre>
<p>需要注意， httpClient 的方法是异步的，所以返回的都是 <code>Obserable</code> ，想要获取返回值需要 <code>subscribe()</code> 。</p>
<pre><code class="language-typescript">this.http.get&lt;string&gt;('https://example.com/ping').subscribe(rep =&gt; {
    console.log(rep);
});
</code></pre>
<p>不过我们不需要自行取消订阅， Angular 帮我们处理好了。</p>
<h2 id="angular-的生命周期">Angular 的生命周期</h2>
<p>了解一个框架，了解它的生命周期是必要的。</p>
<p><img src="https://v2.angular.io/resources/images/devguide/lifecycle-hooks/hooks-in-sequence.png" alt="angular life cycle"></p>
<h3 id="生命周期钩子">生命周期钩子</h3>
<p>Angular中从一个组件的创建到销毁一个有八个生命周期钩子它们,按照先后顺序.它们分别是:</p>
<ul>
<li><code>ngOnChanges()</code></li>
<li><code>ngOnInit()</code></li>
<li><code>ngDoCheck()</code></li>
<li><code>ngAfterContentInit()</code></li>
<li><code>ngAfterContentChecked()</code></li>
<li><code>ngAfterViewInit()</code></li>
<li><code>ngAfterViewChecked()</code></li>
<li><code>ngOnDestroy()</code></li>
</ul>
<p>其中： <code>ngOnInit()</code> 、 <code>ngAfterContentInit()</code> 、 <code>ngAfterViewInit()</code> 和 <code>ngOnDestroy()</code> 在一个组件的生命周期中只会被调用一次，其它的都有可能会被多次调用。</p>
<p>一般用得比较多的是 <code>ngOnInit()</code> 、 <code>ngOnChanges()</code> 、 <code>ngAfterViewInit()</code> 、 <code>ngOnDesctroy()</code>。</p>
<h4 id="ngoninit"><code>ngOnInit()</code></h4>
<p><code>ngOnInit()</code> 是在 Angular 生命周期中必定存在的一个钩子，默认也会在生成的代码里面， implements <code>OnInit</code> 生命周期接口可以更规范。</p>
<p>作用是绑定数据，类似于 Vue 中的 <code>created()</code> 。</p>
<h4 id="ngonchanges"><code>ngOnChanges()</code></h4>
<p>用于监听输入属性和绑定属性变化，如果你不想用 RxJS 实现 watch 的话也可以用 <code>ngOnChanges()</code> 。但 <code>ngOnChanges()</code> 只有一个，难免会痈肿，而且并不能完全监听所有属性。</p>
<p>但 <code>ngOnChanges()</code> 还是很有用的。</p>
<pre><code class="language-typescript">@Input()
public name: string;

ngOnChanges(changes: SimpleChanges): void {
  console.log(changes);
  // name:SimpleChange {previousValue: &quot;a&quot;, currentValue: &quot;ab&quot;, firstChange: false}
}
</code></pre>
<p><strong>同时,还有一点需要注意：</strong> 输入属性为引用类型和为基本类型时，其表现是不同的。当输入属性是基本类型时，你的每一次改变，都会触发 <code>ngOnChanges()</code> 生命周期钩子，而当你的输入属性是引用类型时，你改变你引用类型<strong>当中</strong>的属性时，并不会触发 <code>ngOnChanges()</code> 生命周期钩子。只有当你将<u>所引用数据之指针</u>指向<u>另一块内存地址</u>的时，才会触发 <code>ngOnChanges()</code> 生命周期钩子.</p>
<h4 id="ngafterviewinit"><code>ngAfterViewInit()</code></h4>
<p>所有组件及视图完成加载之后被调用，有点类似于 <code>mounted()</code> 。</p>
<h4 id="ngondestory"><code>ngOnDestory()</code></h4>
<p>组件被摧毁的时候调用，一般是用来清理事件监听和订阅取消较多，反之内存泄漏。</p>
<h2 id="结尾">结尾</h2>
<p>以上便是 Angular 入门的一个简单的教程，其实你可以跟着官方的教程一起对照着本篇文章。既然我们已经完成了基本的入门，那么我们来写一个简单的 Angular 项目吧 ：）</p>
<p><img src="https://img.moegirl.org.cn/common/f/f0/%E7%BC%96%E7%A8%8B%E6%95%B0%E5%AD%A6%E4%B9%A6.jpg" alt=""></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">bigshans</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2021-12-06
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E5%89%8D%E7%AB%AF/">前端</a>
          <a href="/tags/angular/">Angular</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/past-memory-for-high-school/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">旧事记——高中</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/chun-qiu-zuozhuan-zhu-1/">
            <span class="next-text nav-default">抄书——春秋左传注（一）</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
  <div style="display: flex; align-items: center; justify-content: center;">
    <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
  <div style="font-size: 12px; margin-left: 10px">
    This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
  </div>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/bigshans" class="iconfont icon-github" title="github"></a>
  <a href="https://bigshans.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2020 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>bigshans</span>
  </span>
</div>


    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
